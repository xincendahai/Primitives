{"ast":null,"code":"import _classCallCheck from \"/Users/xiangmingxin/Wicrecend/Primitives/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/xiangmingxin/Wicrecend/Primitives/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/xiangmingxin/Wicrecend/Primitives/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/xiangmingxin/Wicrecend/Primitives/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/Users/xiangmingxin/Wicrecend/Primitives/src/components/sketch-ruler/ruler-wrapper.js\";\nimport React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport CanvasRuler from \"./canvas-ruler\";\nimport Line from \"./line\";\n\nvar RulerWrapper = /*#__PURE__*/function (_PureComponent) {\n  _inherits(RulerWrapper, _PureComponent);\n\n  var _super = _createSuper(RulerWrapper);\n\n  function RulerWrapper() {\n    var _this;\n\n    _classCallCheck(this, RulerWrapper);\n\n    _this = _super.call(this);\n\n    _this.handleIndicatorShow = function (value) {\n      return !_this.state.isDraggingLine && _this.setState({\n        showIndicator: true,\n        value: value\n      });\n    };\n\n    _this.handleIndicatorMove = function (value) {\n      return _this.state.showIndicator && _this.setState({\n        value: value\n      });\n    };\n\n    _this.handleIndicatorHide = function () {\n      return _this.setState({\n        showIndicator: false\n      });\n    };\n\n    _this.handleNewLine = function (value) {\n      var _this$props = _this.props,\n          vertical = _this$props.vertical,\n          lines = _this$props.lines,\n          onLineChange = _this$props.onLineChange,\n          handleShowReferLine = _this$props.handleShowReferLine,\n          isShowReferLine = _this$props.isShowReferLine;\n      lines.push(value);\n      onLineChange(lines, vertical);\n      !isShowReferLine && handleShowReferLine();\n    };\n\n    _this.handleLineDown = function () {\n      return _this.setState({\n        isDraggingLine: true\n      });\n    };\n\n    _this.handleLineRelease = function (value, index) {\n      _this.setState({\n        isDraggingLine: false\n      }); // 左右或上下超出时, 删除该条对齐线\n\n\n      var _this$props2 = _this.props,\n          vertical = _this$props2.vertical,\n          start = _this$props2.start,\n          scale = _this$props2.scale,\n          width = _this$props2.width,\n          height = _this$props2.height;\n      var offset = value - start;\n      var maxOffset = (vertical ? height : width) / scale;\n\n      if (offset < 0 || offset > maxOffset) {\n        _this.handleLineRemove(index);\n      } else {\n        var _this$props3 = _this.props,\n            lines = _this$props3.lines,\n            onLineChange = _this$props3.onLineChange;\n        lines[index] = value;\n        onLineChange(lines, vertical);\n      }\n    };\n\n    _this.handleLineRemove = function (index) {\n      var _this$props4 = _this.props,\n          vertical = _this$props4.vertical,\n          lines = _this$props4.lines,\n          onLineChange = _this$props4.onLineChange;\n      lines.splice(index, 1);\n      onLineChange(lines, vertical);\n    };\n\n    _this.onhandleShowRightMenu = function (left, top) {\n      var _this$props5 = _this.props,\n          onShowRightMenu = _this$props5.onShowRightMenu,\n          vertical = _this$props5.vertical;\n      onShowRightMenu(left, top, vertical);\n    };\n\n    _this.state = {\n      isDraggingLine: false,\n      showIndicator: false,\n      value: 0\n    };\n    return _this;\n  }\n\n  _createClass(RulerWrapper, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props6 = this.props,\n          vertical = _this$props6.vertical,\n          scale = _this$props6.scale,\n          width = _this$props6.width,\n          height = _this$props6.height,\n          start = _this$props6.start,\n          selectStart = _this$props6.selectStart,\n          selectLength = _this$props6.selectLength,\n          lines = _this$props6.lines,\n          canvasConfigs = _this$props6.canvasConfigs,\n          isShowReferLine = _this$props6.isShowReferLine;\n      var _this$state = this.state,\n          showIndicator = _this$state.showIndicator,\n          value = _this$state.value;\n      var className = vertical ? \"v-container\" : \"h-container\";\n      var indicatorOffset = (value - start) * scale;\n      var indicatorStyle = vertical ? {\n        top: indicatorOffset\n      } : {\n        left: indicatorOffset\n      };\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: className,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(CanvasRuler, {\n        vertical: vertical,\n        scale: scale,\n        width: width,\n        height: height,\n        start: start,\n        selectStart: selectStart,\n        selectLength: selectLength,\n        canvasConfigs: canvasConfigs,\n        onAddLine: this.handleNewLine,\n        onIndicatorShow: this.handleIndicatorShow,\n        onIndicatorMove: this.handleIndicatorMove,\n        onIndicatorHide: this.handleIndicatorHide,\n        onhandleShowRightMenu: this.onhandleShowRightMenu,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 9\n        }\n      }), isShowReferLine && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"lines\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }\n      }, lines.map(function (v, i) {\n        return /*#__PURE__*/React.createElement(Line, {\n          key: v + i,\n          index: i,\n          value: v >> 0,\n          scale: scale,\n          start: start,\n          vertical: vertical,\n          onRemove: _this2.handleLineRemove,\n          onMouseDown: _this2.handleLineDown,\n          onRelease: _this2.handleLineRelease,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 15\n          }\n        });\n      })), showIndicator && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"indicator\",\n        style: indicatorStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"value\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 13\n        }\n      }, value)));\n    }\n  }]);\n\n  return RulerWrapper;\n}(PureComponent);\n\nexport { RulerWrapper as default };\nRulerWrapper.propTypes = {\n  vertical: PropTypes.bool,\n  scale: PropTypes.number,\n  width: PropTypes.number,\n  height: PropTypes.number,\n  start: PropTypes.number,\n  lines: PropTypes.array,\n  selectStart: PropTypes.number,\n  selectLength: PropTypes.number,\n  canvasConfigs: PropTypes.object,\n  onLineChange: PropTypes.func,\n  onShowRightMenu: PropTypes.func,\n  isShowReferLine: PropTypes.bool,\n  handleShowReferLine: PropTypes.func\n};","map":{"version":3,"sources":["/Users/xiangmingxin/Wicrecend/Primitives/src/components/sketch-ruler/ruler-wrapper.js"],"names":["React","PureComponent","PropTypes","CanvasRuler","Line","RulerWrapper","handleIndicatorShow","value","state","isDraggingLine","setState","showIndicator","handleIndicatorMove","handleIndicatorHide","handleNewLine","props","vertical","lines","onLineChange","handleShowReferLine","isShowReferLine","push","handleLineDown","handleLineRelease","index","start","scale","width","height","offset","maxOffset","handleLineRemove","splice","onhandleShowRightMenu","left","top","onShowRightMenu","selectStart","selectLength","canvasConfigs","className","indicatorOffset","indicatorStyle","map","v","i","propTypes","bool","number","array","object","func"],"mappings":"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","sourcesContent":["import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport CanvasRuler from \"./canvas-ruler\";\nimport Line from \"./line\";\n\nexport default class RulerWrapper extends PureComponent {\n  constructor() {\n    super();\n    this.state = {\n      isDraggingLine: false,\n      showIndicator: false,\n      value: 0\n    };\n  }\n\n  handleIndicatorShow = (value) => !this.state.isDraggingLine && this.setState({ showIndicator: true, value });\n\n  handleIndicatorMove = (value) => this.state.showIndicator && this.setState({ value });\n\n  handleIndicatorHide = () => this.setState({ showIndicator: false });\n\n  handleNewLine = (value) => {\n    const { vertical, lines, onLineChange, handleShowReferLine, isShowReferLine } = this.props;\n    lines.push(value);\n    onLineChange(lines, vertical);\n    !isShowReferLine && handleShowReferLine();\n  };\n\n  handleLineDown = () => this.setState({ isDraggingLine: true });\n\n  handleLineRelease = (value, index) => {\n    this.setState({ isDraggingLine: false });\n    // 左右或上下超出时, 删除该条对齐线\n    const { vertical, start, scale, width, height } = this.props;\n    const offset = value - start;\n    const maxOffset = (vertical ? height : width) / scale;\n\n    if (offset < 0 || offset > maxOffset) {\n      this.handleLineRemove(index);\n    } else {\n      const { lines, onLineChange } = this.props;\n      lines[index] = value;\n      onLineChange(lines, vertical);\n    }\n  };\n\n  handleLineRemove = (index) => {\n    const { vertical, lines, onLineChange } = this.props;\n    lines.splice(index, 1);\n    onLineChange(lines, vertical);\n  };\n\n  // 展示右键菜单\n  onhandleShowRightMenu = (left, top) => {\n    const { onShowRightMenu, vertical } = this.props;\n    onShowRightMenu(left, top, vertical);\n  };\n\n  render() {\n    const {\n      vertical,\n      scale,\n      width,\n      height,\n      start,\n      selectStart,\n      selectLength,\n      lines,\n      canvasConfigs,\n      isShowReferLine\n    } = this.props;\n    const { showIndicator, value } = this.state;\n    const className = vertical ? \"v-container\" : \"h-container\";\n\n    const indicatorOffset = (value - start) * scale;\n    const indicatorStyle = vertical ? { top: indicatorOffset } : { left: indicatorOffset };\n\n    return (\n      <div className={className}>\n        <CanvasRuler\n          vertical={vertical}\n          scale={scale}\n          width={width}\n          height={height}\n          start={start}\n          selectStart={selectStart}\n          selectLength={selectLength}\n          canvasConfigs={canvasConfigs}\n          onAddLine={this.handleNewLine}\n          onIndicatorShow={this.handleIndicatorShow}\n          onIndicatorMove={this.handleIndicatorMove}\n          onIndicatorHide={this.handleIndicatorHide}\n          onhandleShowRightMenu={this.onhandleShowRightMenu}\n        />\n        {isShowReferLine && (\n          <div className=\"lines\">\n            {lines.map((v, i) => (\n              <Line\n                key={v + i}\n                index={i}\n                value={v >> 0}\n                scale={scale}\n                start={start}\n                vertical={vertical}\n                onRemove={this.handleLineRemove}\n                onMouseDown={this.handleLineDown}\n                onRelease={this.handleLineRelease}\n              />\n            ))}\n          </div>\n        )}\n        {showIndicator && (\n          <div className=\"indicator\" style={indicatorStyle}>\n            <span className=\"value\">{value}</span>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\nRulerWrapper.propTypes = {\n  vertical: PropTypes.bool,\n  scale: PropTypes.number,\n  width: PropTypes.number,\n  height: PropTypes.number,\n  start: PropTypes.number,\n  lines: PropTypes.array,\n  selectStart: PropTypes.number,\n  selectLength: PropTypes.number,\n  canvasConfigs: PropTypes.object,\n  onLineChange: PropTypes.func,\n  onShowRightMenu: PropTypes.func,\n  isShowReferLine: PropTypes.bool,\n  handleShowReferLine: PropTypes.func\n};\n"]},"metadata":{},"sourceType":"module"}