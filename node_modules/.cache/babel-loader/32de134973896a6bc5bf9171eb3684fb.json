{"ast":null,"code":"import \"antd/es/drawer/style\";\nimport _Drawer from \"antd/es/drawer\";\nimport \"antd/es/modal/style\";\nimport _Modal from \"antd/es/modal\";\nimport _slicedToArray from \"/Users/xiangmingxin/Wicrecend/\\u56FE\\u5143/react-visual-data/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"/Users/xiangmingxin/Wicrecend/\\u56FE\\u5143/react-visual-data/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/Users/xiangmingxin/Wicrecend/\\u56FE\\u5143/react-visual-data/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n\nvar _jsxFileName = \"/Users/xiangmingxin/Wicrecend/\\u56FE\\u5143/react-visual-data/src/materials/form/map/index.js\",\n    _this = this;\n\nimport React, { memo, useState } from \"react\";\nimport { toRawType } from \"~utils/helper\";\n\nfunction SubComponent(p) {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"field-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 7,\n      columnNumber: 5\n    }\n  }, Object.keys(p.value).map(function (name) {\n    return p.getSubField({\n      name: name,\n      value: p.value[name],\n      onChange: function onChange(key, val, objValue) {\n        var value = _objectSpread(_objectSpread({}, p.value), {}, _defineProperty({}, key, val)); // 第三个参数，允许object里的一个子控件改动整个object的值\n\n\n        if (objValue) {\n          value = objValue;\n        }\n\n        p.onChange(p.name, value);\n      },\n      rootValue: p.value\n    });\n  }));\n}\n\nvar MapWithModal = function MapWithModal(props) {\n  var _ref = props || {},\n      _ref$options = _ref.options,\n      options = _ref$options === void 0 ? {} : _ref$options,\n      schema = _ref.schema;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      show = _useState2[0],\n      setShow = _useState2[1];\n\n  var toggle = function toggle() {\n    return setShow(function (o) {\n      return !o;\n    });\n  }; // 模态框\n\n\n  if (options && options.modal) {\n    var config = toRawType(options.modal) === \"object\" ? options.modal : {};\n    var text = config.text;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"a\", {\n      onClick: toggle,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 9\n      }\n    }, text && toRawType(text) === \"string\" ? \"+ \" + text : \"+ 配置\"), /*#__PURE__*/React.createElement(_Modal, Object.assign({\n      title: schema && schema.title || \"子配置\",\n      visible: show,\n      onCancel: toggle,\n      footer: null,\n      width: \"80%\"\n    }, config, {\n      style: _objectSpread({\n        maxWidth: 800\n      }, config.style),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(SubComponent, Object.assign({}, props, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 11\n      }\n    }))));\n  } // 抽屉\n\n\n  if (options && options.drawer) {\n    var _config = toRawType(options.drawer) === \"object\" ? options.drawer : {};\n\n    var _text = _config.text;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"a\", {\n      onClick: toggle,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }\n    }, _text && toRawType(_text) === \"string\" ? \"+ \" + _text : \"+ 配置\"), /*#__PURE__*/React.createElement(_Drawer, Object.assign({\n      title: schema && schema.title || \"子配置\",\n      visible: show,\n      onClose: toggle,\n      width: \"30%\"\n    }, _config, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(SubComponent, Object.assign({}, props, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 11\n      }\n    }))));\n  }\n\n  return /*#__PURE__*/React.createElement(SubComponent, Object.assign({}, props, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 10\n    }\n  }));\n};\n\nexport default memo(MapWithModal);","map":{"version":3,"sources":["/Users/xiangmingxin/Wicrecend/图元/react-visual-data/src/materials/form/map/index.js"],"names":["React","memo","useState","toRawType","SubComponent","p","Object","keys","value","map","name","getSubField","onChange","key","val","objValue","rootValue","MapWithModal","props","options","schema","show","setShow","toggle","o","modal","config","text","title","maxWidth","style","drawer"],"mappings":"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","sourcesContent":["import React, { memo, useState } from \"react\";\nimport { Modal, Drawer } from \"antd\";\nimport { toRawType } from \"~utils/helper\";\n\nfunction SubComponent(p) {\n  return (\n    <div className=\"field-wrapper\">\n      {Object.keys(p.value).map((name) => {\n        return p.getSubField({\n          name,\n          value: p.value[name],\n          onChange(key, val, objValue) {\n            let value = { ...p.value, [key]: val };\n            // 第三个参数，允许object里的一个子控件改动整个object的值\n            if (objValue) {\n              value = objValue;\n            }\n            p.onChange(p.name, value);\n          },\n          rootValue: p.value\n        });\n      })}\n    </div>\n  );\n}\n\nconst MapWithModal = (props) => {\n  const { options = {}, schema } = props || {};\n  const [show, setShow] = useState(false);\n  const toggle = () => setShow((o) => !o);\n  // 模态框\n  if (options && options.modal) {\n    const config = toRawType(options.modal) === \"object\" ? options.modal : {};\n    const { text } = config;\n    return (\n      <>\n        <a onClick={toggle}>{text && toRawType(text) === \"string\" ? \"+ \" + text : \"+ 配置\"}</a>\n        <Modal\n          title={(schema && schema.title) || \"子配置\"}\n          visible={show}\n          onCancel={toggle}\n          footer={null}\n          width=\"80%\"\n          {...config}\n          style={{ maxWidth: 800, ...config.style }}\n        >\n          <SubComponent {...props} />\n        </Modal>\n      </>\n    );\n  }\n  // 抽屉\n  if (options && options.drawer) {\n    const config = toRawType(options.drawer) === \"object\" ? options.drawer : {};\n    const { text } = config;\n    return (\n      <>\n        <a onClick={toggle}>{text && toRawType(text) === \"string\" ? \"+ \" + text : \"+ 配置\"}</a>\n        <Drawer title={(schema && schema.title) || \"子配置\"} visible={show} onClose={toggle} width=\"30%\" {...config}>\n          <SubComponent {...props} />\n        </Drawer>\n      </>\n    );\n  }\n\n  return <SubComponent {...props} />;\n};\n\nexport default memo(MapWithModal);\n"]},"metadata":{},"sourceType":"module"}