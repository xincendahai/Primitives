{"ast":null,"code":"import _regeneratorRuntime from \"/Users/xiangmingxin/Wicrecend/\\u56FE\\u5143/react-visual-data/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/xiangmingxin/Wicrecend/\\u56FE\\u5143/react-visual-data/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/xiangmingxin/Wicrecend/\\u56FE\\u5143/react-visual-data/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/xiangmingxin/Wicrecend/\\u56FE\\u5143/react-visual-data/src/pages/report/index.jsx\";\n\n/**\n * core 编辑器渲染核心代码\n */\nimport React, { useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { AxureGrid } from \"~renderer\";\nimport AxureLayoutAside from \"./src/aside\";\nimport AxureLayoutHeader from \"./src/header\";\nimport AxureLayoutContent from \"./src/wrapper\";\nimport AxureLayoutField from \"./src/setting\";\nimport { dataVGrid, dataVApiList, dataVSqlList } from \"@/api\";\nimport { useSet, useDocumentTitle } from \"~common/hooks\";\nimport { Ctx, StoreCtx } from \"~common/hooks\";\nimport { pathToParam, loadScript } from \"~utils\";\nloadScript(\"https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css\", \"css\"); // 设计模式组件(components)和条件(conditions)抽离\n\nfunction DataProvider(_ref) {\n  var dispatch = _ref.dispatch;\n  useDocumentTitle(\"DataV Pro - 数据报表\");\n\n  var _useSet = useSet({\n    tabsKey: \"base\",\n    components: [],\n    page: {\n      name: \"\",\n      remark: \"\",\n      backgroundMode: \"define\",\n      backgroundColor: \"rgba(29, 33, 39, 1)\",\n      backgroundImage: \"\",\n      backgroundDefine: \"background-2.png\",\n      backgroundBlur: 0,\n      backgroundOpacity: 10\n    },\n    undo: [],\n    redo: []\n  }),\n      _useSet2 = _slicedToArray(_useSet, 2),\n      state = _useSet2[0],\n      setState = _useSet2[1]; // 其他无关状态\n\n\n  var _useSet3 = useSet({\n    layerCollapsed: false,\n    settingCollapsed: false,\n    visible: false\n  }),\n      _useSet4 = _slicedToArray(_useSet3, 2),\n      view = _useSet4[0],\n      setView = _useSet4[1]; // 异步多接口请求\n\n\n  var storageData = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var results;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return Promise.all([dataVApiList(), dataVSqlList()]).then(function (ret) {\n                return ret;\n              });\n\n            case 3:\n              results = _context.sent;\n              dispatch({\n                type: \"component/api\",\n                data: results[0].data\n              });\n              dispatch({\n                type: \"component/sql\",\n                data: results[1].data\n              });\n              _context.next = 11;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](0);\n              console.warn(_context.t0);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 8]]);\n    }));\n\n    return function storageData() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var fetchData = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _yield$dataVGrid, data;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return dataVGrid();\n\n            case 2:\n              _yield$dataVGrid = _context2.sent;\n              data = _yield$dataVGrid.data;\n              setState({\n                page: data.page,\n                components: data.components\n              });\n              dispatch({\n                type: \"component/activeKey\",\n                data: \"-\"\n              });\n              dispatch({\n                type: \"form/conditions\",\n                data: data.conditions\n              });\n              dispatch({\n                type: \"form/dependencies\",\n                data: data.components.filter(function (m) {\n                  return m.type !== \"container\";\n                }).map(function (item) {\n                  return item.uniqueId;\n                })\n              });\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function fetchData() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    dispatch({\n      type: \"component/mode\",\n      data: \"development\"\n    });\n    dispatch({\n      type: \"component/drilldown\",\n      data: []\n    });\n    dispatch({\n      type: \"component/querys\",\n      data: pathToParam()\n    });\n    dispatch({\n      type: \"tab/component\",\n      data: []\n    });\n    dispatch({\n      type: \"form/parmas\",\n      data: []\n    });\n    fetchData();\n    storageData();\n  }, []);\n  return /*#__PURE__*/React.createElement(Ctx.Provider, {\n    value: {\n      state: state,\n      setState: setState\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(StoreCtx.Provider, {\n    value: {\n      view: view,\n      setView: setView\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"gc-design\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(AxureLayoutHeader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"section\", {\n    className: \"gc-design__bd\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(AxureLayoutAside, {\n    title: \"Axure v2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(AxureLayoutContent, Object.assign({}, state.page, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(AxureGrid, {\n    dataGrid: state.components,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(AxureLayoutField, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  })))));\n}\n\nexport default connect(function (state) {\n  return {\n    conditions: state.form.conditions\n  };\n})(DataProvider);","map":{"version":3,"sources":["/Users/xiangmingxin/Wicrecend/图元/react-visual-data/src/pages/report/index.jsx"],"names":["React","useEffect","connect","AxureGrid","AxureLayoutAside","AxureLayoutHeader","AxureLayoutContent","AxureLayoutField","dataVGrid","dataVApiList","dataVSqlList","useSet","useDocumentTitle","Ctx","StoreCtx","pathToParam","loadScript","DataProvider","dispatch","tabsKey","components","page","name","remark","backgroundMode","backgroundColor","backgroundImage","backgroundDefine","backgroundBlur","backgroundOpacity","undo","redo","state","setState","layerCollapsed","settingCollapsed","visible","view","setView","storageData","Promise","all","then","ret","results","type","data","console","warn","fetchData","conditions","filter","m","map","item","uniqueId","form"],"mappings":"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","sourcesContent":["/**\n * core 编辑器渲染核心代码\n */\nimport React, { useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { AxureGrid } from \"~renderer\";\nimport AxureLayoutAside from \"./src/aside\";\nimport AxureLayoutHeader from \"./src/header\";\nimport AxureLayoutContent from \"./src/wrapper\";\nimport AxureLayoutField from \"./src/setting\";\nimport { dataVGrid, dataVApiList, dataVSqlList } from \"@/api\";\nimport { useSet, useDocumentTitle } from \"~common/hooks\";\nimport { Ctx, StoreCtx } from \"~common/hooks\";\nimport { pathToParam, loadScript } from \"~utils\";\n\nloadScript(\"https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css\", \"css\");\n\n// 设计模式组件(components)和条件(conditions)抽离\nfunction DataProvider({ dispatch }) {\n  useDocumentTitle(\"DataV Pro - 数据报表\");\n  const [state, setState] = useSet({\n    tabsKey: \"base\",\n    components: [],\n    page: {\n      name: \"\",\n      remark: \"\",\n      backgroundMode: \"define\",\n      backgroundColor: \"rgba(29, 33, 39, 1)\",\n      backgroundImage: \"\",\n      backgroundDefine: \"background-2.png\",\n      backgroundBlur: 0,\n      backgroundOpacity: 10\n    },\n    undo: [],\n    redo: []\n  });\n\n  // 其他无关状态\n  const [view, setView] = useSet({\n    layerCollapsed: false,\n    settingCollapsed: false,\n    visible: false\n  });\n\n  // 异步多接口请求\n  const storageData = async () => {\n    try {\n      const results = await Promise.all([dataVApiList(), dataVSqlList()]).then((ret) => {\n        return ret;\n      });\n      dispatch({ type: \"component/api\", data: results[0].data });\n      dispatch({ type: \"component/sql\", data: results[1].data });\n    } catch (err) {\n      console.warn(err);\n    }\n  };\n\n  const fetchData = async () => {\n    const { data } = await dataVGrid();\n    setState({ page: data.page, components: data.components });\n    dispatch({ type: \"component/activeKey\", data: \"-\" });\n    dispatch({ type: \"form/conditions\", data: data.conditions });\n    dispatch({\n      type: \"form/dependencies\",\n      data: data.components.filter((m) => m.type !== \"container\").map((item) => item.uniqueId)\n    });\n  };\n\n  useEffect(() => {\n    dispatch({ type: \"component/mode\", data: \"development\" });\n    dispatch({ type: \"component/drilldown\", data: [] });\n    dispatch({ type: \"component/querys\", data: pathToParam() });\n    dispatch({ type: \"tab/component\", data: [] });\n    dispatch({ type: \"form/parmas\", data: [] });\n\n    fetchData();\n    storageData();\n  }, []);\n\n  return (\n    <Ctx.Provider value={{ state, setState }}>\n      <StoreCtx.Provider value={{ view, setView }}>\n        <div className=\"gc-design\">\n          <AxureLayoutHeader />\n          <section className=\"gc-design__bd\">\n            <AxureLayoutAside title=\"Axure v2\" />\n            <AxureLayoutContent {...state.page}>\n              <AxureGrid dataGrid={state.components} />\n            </AxureLayoutContent>\n            <AxureLayoutField />\n          </section>\n        </div>\n      </StoreCtx.Provider>\n    </Ctx.Provider>\n  );\n}\n\nexport default connect((state) => ({\n  conditions: state.form.conditions\n}))(DataProvider);\n"]},"metadata":{},"sourceType":"module"}